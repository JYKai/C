# 문자

## 아스키 코드 값과 문자 입출력 함수

### 아스키 코드
128개의 문자을 0 ~ 127의 숫자 중에 각각 어떤 값으로 표현할지 정의한 것
- 알파벳과 숫자는 각각 연속된 아스키 코드 값을 갖는다.
- 소문자가 대문자보다 아스키 코드 값이 크다.
- 제어 문자는 백슬래시와 함께 표시하며 출력할 때 그 기능을 수행한다.
```c
// 대문자를 소문자로 변경

#include <stdio.h>

int main(void)
{
    char small, cap = 'G';

    if ((cap >= 'A') && (cap <= 'Z'))     // 대문자 범위라면
    {
        small = cap + ('a' - 'A');        // 대/소문자의 차이를 더해 소문자로 변환
    }

    printf("대문자 : %c %c", cap, '\n');    // '\n'을 %c로 출력하면 줄이 바뀐다.
    printf("소문자 : %c", small);

    return 0;
}
```
- 문자 상수는 4바이트의 크기를 갖지만 아스키 코드 값이 0 ~ 127의 범위에 있으므로 2진수로 바꾸면 왼쪽 3바이트는 모두 0이 되고 오른쪽 1바이트만 의미를 갖는다. 따라서, 문자는 1바이트 크기의 char형 변수에 저장해 사용할 수 있다.
    - 컴파일러는 오른쪽 1바이트만 변수에 저장하고 남은 바이트는 버린다.


### scanf 함수를 사용한 문자 입력
```c
// 공백이나 제어 문자의 입력

#include <stdio.h>

int main(void)
{
    char ch1, ch2;

    scanf("%c%c", &ch1, &ch2);
    printf("[%c%c]", ch1, ch2);

    return 0;
}
```
- 여러 개의 문자를 입력할 때 데이터를 구분하기 위해 칸을 띄우가나 Tab을 사용하면 공백 문자나 탭 문자가 데이터로 입력될 수 있다.
    - Space Bar, Tab, Enter = 화이트 스페이스 : %d, %lf, %s와 같은 변환 문자로 숫자나 문자열을 입력할 때는 데이터를 구분하는 용도로 사용된다.
- ```scanf("%d %d", &a, &b)```
    - 키보드로 '10(공백)20'과 같이 입력하면 중간의 공백 문자는 10과 20을 구분하는 용도로만 쓰인다.
    - %c는 문자를 입력하므로 화이트 스페이스도 입력 대상이 된다.
- ```scanf(" %c %c", &ch1, &ch2)```
    - ```scanf``` 함수는 %c 앞에 화이트 스페이스를 사용하면 문자도 분리하여 입력할 수 있는 특별한 기능이 있다.
        - 일반적으로 공백을 사용하여 분리하는 것이 쉬우므로 보통 한 칸을 띄워준다.


### getchar 함수와 putchar 함수
```scanf``` 함수는 문자뿐만 아니라 숫자도 입력하는 기능이 포함되어 있으므로 문자만 입력하는 함수에 비해 크기가 크다.  
문자만 입출력하는 경우 문자 전용 함수를 사용하는 것이 효율적이며, ```getchar``` 함수와 ```putchar``` 함수는 문자 전용 입출력 함수이다.
```c
// 함수 원형
int getchar(void); // 매개변수가 없고 입력한 문자를 반환한다.
int putchar(int);  // 출력할 문자를 인수로 준다.
```

```c
// getchar, putchar

#include <stdio.h>

int main(void)
{
    int ch;             // 입력 문자를 저장할 변수

    ch = getchar();     // 함수가 반환하는 문자를 바로 저장
    printf("입력한 문자: ");
    putchar(ch);        // 입력한 문자 출력
    putchar('\n');      // 개행 문자 출력

    return 0;
}
```
- ```getchar``` 함수는 매개변수가 없으므로 괄호만 사용하여 호출한다.
    - 입력한 문자의 아스키 코드 값으 반환하므로 반환값은 int형 변수로 받는다.
        - 반환형이 int형인 이유는 문자 이외의 값도 반환하기 때문이다. 문자의 입력을 끝내기 위해 Ctrl + Z를 누르면 -1 을 반환하게 되는데 이 값을 문자와 정확하기 구분하기 위해서이다.
    - 반환값은 필요에 따라 char형 변수나 배열에 옮겨 문자나 문자열로 사용한다.
    - 공백 문자, 탭 문자, 개행 문자도 입력하는데 이들 문자를 제외하는 옵션은 없다.
- ```putchar``` 함수는 문자 상수나 문자의 아스키 코드 값을 인수로 주면 해당 문자를 화면에 출력한다.
    - 출력한 문자를 다시 반환하며 출력 과정에서 에러가 발생하면 -1을 반환한다.

</br>

## 버퍼를 사용하는 입력 함수
버퍼는 프로그램에서 직접 할당하는 것이 아니고 프로그램을 실행하는 중에 운영체제가 자동으로 할당하는 메모리의 저장 공간이다.
- 키도브에 입력하는 데이터는 일단 버퍼에 저장된 후에 ```scanf``` 함수에 의해 변수에 입력된다.

### scanf 함수가 문자를 입력하는 과정
버퍼는 데이터를 보관하는 역할을 하므로 최초 입력할 때 필요한 데이터를 한꺼번에 저장해놓으면 ```scanf``` 함수는 호출 즉시 버퍼에서 데이터를 가져올 수 있다.
```c
// 버퍼를 사용하는 문자 입력

#include <stdio.h>

int main(void)
{
    char ch;
    int i;

    for (i = 0; i < 3; i++)
    {
        scanf("%c", &ch);       // tiger
        printf("%c", ch);       // tig
    }

    return 0;
}
```
- 문자를 입력하고 화면에 출력하는 과정을 세 번 반복하지만, 실행결과는 한 번의 키보드 입력으로 끝난다.
- 최초 ```scanf``` 함수가 호출될 때 키보드로 문자열을 입력하면 일단 버퍼에 저장한 후에 첫 번째 문자만 변수에 저장한다.
    - 두 번째 ```scanf``` 함수 호출부터는 버퍼에 남아 있는 문자열에서 차례로 다음 문자를 가져오므로 결국 새로운 키보드 입력이 필요 없다.
    - 버퍼에 저장된 데이터를 모두 가져온다면 추가로 데이터를 입력해야 한다.
- 입력 데이터는 Enter를 누르는 순간 버퍼에 저장되며 개행 문자도 함께 저장된다.
    - 버퍼에 있는 개행 문자도 하나의 데이터로 입력될 수 있으며, 이를 활용한 프로그래밍도 가능하다.
    - 개행 문자가 나올 때까지 문자를 반복적으로 입력하여 출력하면 키보드로 입력한 한 줄의 데이터를 길이와 상관없이 화면에 출력할 수 있다.
    ```c
    while (1)
    {
        scanf("%c", &ch);       // 버퍼에서 한 문자 입력 받음
        if (ch == '\n') { break; }
        printf("%c", ch);
    }
    ```

**입출력 함수가 버퍼를 사용하면 좋은 점**  
1. 데이터를 안정적으로 입력받을 수 있다.
- 프로그램이 다른 일을 하느라 해당 입력을 즉시 받지 못해도 데이터가 사라지지 않아 안정적이다.
2. 입력장치와 독립적으로 사용할 수 있다.
- ```scanf``` 함수는 키보드와 직접 연결되지 않고 정해진 크기와 형태를 가진 버퍼에서 입력을 받는다. 따라서 입력장치가 바뀌더라도 함수를 수정하지 않고 사용할 수 있다.


### scanf 함수 반환값 활용
```scanf``` 함수는 키보드로 Crtl + Z 를 누르면 -1을 반환한다. (운영체제에 따라 키보드 입력 방식이 달라질 수 있다.)
- 결국 ```scanf``` 함수가 -1을 반환하기 전까지 반복 입력하면 개행 문자를 포함한 모든 문자를 데이터로 사용할 수 있다.
```c
// 입력 문자의 아스키 코드 값을 출력하는 프로그램

#include <stdio.h>

int main(void)
{
    int res;                // scanf 함수의 반환값을 저장할 변수
    char ch;                // 문자를 입력할 변수

    while (1)
    {
        res = scanf("%c", &ch);     // 문자 입력, <Ctrl> + <Z> 를 누르면 -1 반환
        if (res == -1) { break; }
        printf("%d", ch);           // 입력된 문자의 아스키 코드 값 출력
    }

    return 0;
}
```
- ```scanf``` 함수는 기본적으로 입력한 값의 개수를 반환한다.
    - 문자를 제대로 입력한 경우 1을 반환한다.
    - ctrl Z를 동시에 누르면 -1을 반환한다.
- 키보드로 숫자를 입력하는 경우에도 일단 문자열의 형태로 버퍼에 저장된다. 그 후에 문자열이 실제 연산이 가능한 값으로 변환되어 변수에 저장된다.


### getchar 함수를 사용한 문자열 입력
```getchar``` 함수도 버퍼를 사용하는 문자 입력 함수다.
- 반복 사용하면 한 줄의 문자열을 char 배열에 입력할 수 있다.
```c
// getchar 함수를 사용한 문자열 입력

#include <stdio.h>

void my_gets(char *str, int size);

int main(void)
{
    char str[7];

    my_gets(str, sizeof(str));
    printf("입력한 문자열 : %s\n", str);

    return 0;
}

void my_gets(char *str, int size)
{
    int ch;
    int i = 0;

    ch = getchar();
    while ((ch != '\n') && (i < size - 1))
    {
        str[i] = ch;
        i++;
        ch = getchar();
    }
    str[i] = '\0';      // 입력된 문자열 끝에 널 문자를 저장
}
```


### 입력 버퍼 지우기
```c
// 버퍼의 내용을 지워야 하는 경우

#include <stdio.h>

int main(void)
{
    int num, grade;

    printf("학번 입력 : ");
    scanf("%d", &num);
    getchar();
    printf("학점 입력 : ");
    grade = getchar();
    printf("학번 : %d, 학점 : %c", num, grade);

    return 0;
}
```
- ```getchar();```
    - 중간의 ```getchar``` 함수를 사용하여 개행 문자를 제거해야한다.

**stdin과 stdout**  
문자 입출력 함수에는 ```fgetc```와 ```fputc```도 있다.
- 이들은 호출할 때 추가적인 인수가 필요한데 ```fgetc```는 stdin을 주고, ```fputc```는 stdout을 준다.
- 별도로 인수를 주는 것 외에는 ```getchar```, ```putchar``` 함수와 기능은 같다.